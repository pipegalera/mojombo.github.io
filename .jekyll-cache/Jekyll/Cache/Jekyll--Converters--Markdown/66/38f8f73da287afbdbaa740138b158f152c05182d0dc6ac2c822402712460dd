I"â§<h1 id="how-to-audit-gender-pay-gap-for-a-company-using-python">How to Audit Gender Pay Gap for a company using Python</h1>

<h1 id="introduction">Introduction</h1>

<p>In this post I will go though a technical step-by-step guide for how to analyze your company‚Äôs gender pay gap (including example data and code).</p>

<p>Gender Pay Gap remains a recurrent problem at many companies. In the United States, Pew Research Center evaluated the trend in gender pay gap from the 1980 until 2020 and discovered that women earned 84% of what men earned. In other words, it would take an extra 42 days of work for women to earn what men did in 2020.</p>

<p>While this gap is closing, <a href="https://www.pewresearch.org/fact-tank/2021/05/25/gender-pay-gap-facts/">specially for young workers</a>, is still an issue that can affect the morale of the company as whole, the decision of prospect candidates to apply to your company, or corrupt the meritocracy system in promotions just to mention a few problems that can derive from not taking into account the Gender Pay Gap.</p>

<p>For this post I will go though a technical step-by-step guide for how to analyze your company‚Äôs gender pay gap (including example data and code) showing how to apply statistical methods to evauate Gender Pay Gap and move forward a better gender pay fairness.</p>

<p>We will analyze two types:</p>

<ol>
  <li>
    <p><strong>Unadjusted Gender Pay Gap</strong>. Is there a difference between average pay for men and women in the company?</p>
  </li>
  <li>
    <p><strong>Adjusted Gender Pay Gap</strong>. Are there differences between average pay for men and women <strong>after we‚Äôve accounted for differences among workers</strong> in education, experience, job roles, employee performance and other factors aside from gender
that affect pay?</p>
  </li>
</ol>

<p>The sections include several <strong>insights</strong> that explains the results marked with a üìå sign.</p>

<h1 id="1-unadjusted-gender-pay-gap">1. Unadjusted Gender Pay Gap</h1>

<p><strong>Is there a difference between average pay for men and women in the company?</strong></p>

<p>We will start defining Unadjusted Gender Pay Gap: the <strong>percentage of salary paid to male with respect to female workers</strong>.</p>

\[\begin{aligned}
Unadjusted \ Gender \ Pay \ Gap = \frac{Average \ Male \ Pay - Average \ Female \ Pay}{Average \ Male \ Pay}
\end{aligned}\]

<p>This is the simplest definition for Gender Pay Gap. This Pay Gap is ‚Äúunadjusted‚Äù in the sense that it doesn‚Äôt take into account other factors but gender. Once we have this Unadjusted Gender Pay Gap we will include more factors that pay a role in pay differences.</p>

<p>For the analysis, we will use a <strong>sample of data</strong> from the job seekers website Glassdoor that contains 1000 people with the following information:</p>

<ul>
  <li>Job title</li>
  <li>Gender</li>
  <li>Age</li>
  <li>Score on most recent performance evaluation (1 to 5)</li>
  <li>Education</li>
  <li>Company department</li>
  <li>Seniority (1 to 5)</li>
  <li>Annual base salary</li>
  <li>Annual bonuses, comimissions, stock awards or other compensations</li>
</ul>

<p>We will load the data using <code class="language-plaintext highlighter-rouge">pandas</code> and we will use <code class="language-plaintext highlighter-rouge">numpy</code> to create numerical variables.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"https://glassdoor.box.com/shared/static/beukjzgrsu35fqe59f7502hruribd5tt.csv"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 9 columns):
 #   Column     Non-Null Count  Dtype 
---  ------     --------------  ----- 
 0   jobTitle   1000 non-null   object
 1   gender     1000 non-null   object
 2   age        1000 non-null   int64 
 3   perfEval   1000 non-null   int64 
 4   edu        1000 non-null   object
 5   dept       1000 non-null   object
 6   seniority  1000 non-null   int64 
 7   basePay    1000 non-null   int64 
 8   bonus      1000 non-null   int64 
dtypes: int64(5), object(4)
memory usage: 70.4+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>jobTitle</th>
      <th>gender</th>
      <th>age</th>
      <th>perfEval</th>
      <th>edu</th>
      <th>dept</th>
      <th>seniority</th>
      <th>basePay</th>
      <th>bonus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Graphic Designer</td>
      <td>Female</td>
      <td>18</td>
      <td>5</td>
      <td>College</td>
      <td>Operations</td>
      <td>2</td>
      <td>42363</td>
      <td>9938</td>
    </tr>
    <tr>
      <td>Software Engineer</td>
      <td>Male</td>
      <td>21</td>
      <td>5</td>
      <td>College</td>
      <td>Management</td>
      <td>5</td>
      <td>108476</td>
      <td>11128</td>
    </tr>
    <tr>
      <td>Warehouse Associate</td>
      <td>Female</td>
      <td>19</td>
      <td>4</td>
      <td>PhD</td>
      <td>Administration</td>
      <td>5</td>
      <td>90208</td>
      <td>9268</td>
    </tr>
    <tr>
      <td>Software Engineer</td>
      <td>Male</td>
      <td>20</td>
      <td>5</td>
      <td>Masters</td>
      <td>Sales</td>
      <td>4</td>
      <td>108080</td>
      <td>10154</td>
    </tr>
    <tr>
      <td>Graphic Designer</td>
      <td>Male</td>
      <td>26</td>
      <td>5</td>
      <td>Masters</td>
      <td>Engineering</td>
      <td>5</td>
      <td>99464</td>
      <td>9319</td>
    </tr>
  </tbody>
</table>

<p class="alert-info">Using your own data, please be sure to keep all personally identifying information out of the data file. Personal names or employee numbers should not be in the file. It‚Äôs important to protect employee privacy and anonymity at all times while conducting a gender pay audit. </p>

<p>We can start the analysis by creating a pandas‚Äô <code class="language-plaintext highlighter-rouge">pivot_table()</code> that groups the workers by gender and prints the mean and median salaries:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">male_female_table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> 
                                   <span class="n">index</span> <span class="o">=</span> <span class="s">'gender'</span><span class="p">,</span> 
                                   <span class="n">values</span> <span class="o">=</span> <span class="s">'basePay'</span><span class="p">,</span> 
                                   <span class="n">aggfunc</span><span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">median</span><span class="p">,</span> <span class="s">'count'</span><span class="p">])</span>
<span class="n">male_female_table</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>count</th>
    </tr>
    <tr>
      <th></th>
      <th>basePay</th>
      <th>basePay</th>
      <th>basePay</th>
    </tr>
    <tr>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Female</th>
      <td>89942.818376</td>
      <td>89913.5</td>
      <td>468</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>98457.545113</td>
      <td>98223.0</td>
      <td>532</td>
    </tr>
  </tbody>
</table>

<p>The company has <strong>more male workers and they earn more by average</strong>.</p>

<p class="mark">Why we have calculated the median? It is useful?</p>

<p>Calculating the median pay along the average is important as <strong>the average can be affected by outliers</strong> and therefore could picture a misleading general image of the pay scheme.</p>

<p>For example, a highly paid female CEO can raise the average pay of women, but it is only an outliear and would not represent the general pay scheme of women within the company. That is why is important to add the median and observe if there is a difference between the mean and the median that could signal outliers.</p>

<p>For this specific dataset, the median and mean are similar, and both can be used to depict the general payroll of the company.</p>

<p>We can code some cosmetic changes to get the right format, but they are entirely optional:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Cosmetic changes of the table
</span><span class="n">male_female_table</span> <span class="o">=</span> <span class="p">(</span><span class="n">male_female_table</span><span class="p">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                      <span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
                                      <span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="s">'level_1'</span><span class="p">)</span>
                                      <span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">"gender"</span><span class="p">)</span>
                                      <span class="p">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
                                      <span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>               
                    <span class="p">)</span>

<span class="n">male_female_table</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Female</th>
      <td>89942</td>
      <td>89913</td>
      <td>468</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>98457</td>
      <td>98223</td>
      <td>532</td>
    </tr>
  </tbody>
</table>

<p>To calculate the exact difference between the base salary of male and female workers we can use <code class="language-plaintext highlighter-rouge">diff()</code> and <code class="language-plaintext highlighter-rouge">pct_change()</code>. We can use<code class="language-plaintext highlighter-rouge">diff()</code> to calculate the difference in absolute terms and <code class="language-plaintext highlighter-rouge">pct_change()</code> for the percentage difference between both genders. The table can be transposed using the <code class="language-plaintext highlighter-rouge">T</code> method to display the data more clearly.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">male_female_table</span><span class="p">.</span><span class="n">diff</span><span class="p">()[</span><span class="mi">1</span><span class="p">:].</span><span class="n">T</span>
</code></pre></div></div>

<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>8515.0</td>
    </tr>
    <tr>
      <th>median</th>
      <td>8310.0</td>
    </tr>
    <tr>
      <th>count</th>
      <td>64.0</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">male_female_table</span><span class="p">.</span><span class="n">pct_change</span><span class="p">()[</span><span class="mi">1</span><span class="p">:].</span><span class="n">T</span>
</code></pre></div></div>

<table>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>0.094672</td>
    </tr>
    <tr>
      <th>median</th>
      <td>0.092423</td>
    </tr>
    <tr>
      <th>count</th>
      <td>0.136752</td>
    </tr>
  </tbody>
</table>

<p>From this first analysis we can get a first round of insights.</p>

<h2 id="-first-round-of-insights-">üìå First round of Insights üìå</h2>

<ul>
  <li><strong>Unadjusted</strong> Gender Pay Gap is present in the company.</li>
  <li><strong>Male workers get paid 9.5% more base salary</strong> than female workers on average, which represents roughly 8.5k more annually.</li>
  <li>There are roughly <strong>14% more male workers</strong> in the company.</li>
  <li>There is a difference between average pay for men and women in the company, but <strong>we don‚Äôt if the cause is gender or other characteristics</strong>.</li>
</ul>

<p>To get a little more deep into the gender differences within this hyphotetical company, let‚Äôs group the workers into their respective roles using <code class="language-plaintext highlighter-rouge">pivot_table()</code> again.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">salary_by_gender_jobtitle</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
                                           <span class="n">values</span><span class="o">=</span> <span class="s">'basePay'</span><span class="p">,</span>
                                           <span class="n">index</span> <span class="o">=</span> <span class="s">'jobTitle'</span><span class="p">,</span>
                                           <span class="n">columns</span><span class="o">=</span> <span class="s">'gender'</span><span class="p">,</span>
                                           <span class="n">aggfunc</span><span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">,</span> <span class="s">'count'</span><span class="p">])</span>


<span class="n">salary_by_gender_jobtitle</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mean</th>
      <th colspan="2" halign="left">count</th>
    </tr>
    <tr>
      <th>gender</th>
      <th>Female</th>
      <th>Male</th>
      <th>Female</th>
      <th>Male</th>
    </tr>
    <tr>
      <th>jobTitle</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Data Scientist</th>
      <td>95704.792453</td>
      <td>89222.629630</td>
      <td>53</td>
      <td>54</td>
    </tr>
    <tr>
      <th>Driver</th>
      <td>86867.630435</td>
      <td>91952.666667</td>
      <td>46</td>
      <td>45</td>
    </tr>
    <tr>
      <th>Financial Analyst</th>
      <td>95458.326531</td>
      <td>94607.034483</td>
      <td>49</td>
      <td>58</td>
    </tr>
    <tr>
      <th>Graphic Designer</th>
      <td>92243.291667</td>
      <td>89595.800000</td>
      <td>48</td>
      <td>50</td>
    </tr>
    <tr>
      <th>IT</th>
      <td>90475.720000</td>
      <td>91021.978261</td>
      <td>50</td>
      <td>46</td>
    </tr>
    <tr>
      <th>Manager</th>
      <td>127252.277778</td>
      <td>124848.930556</td>
      <td>18</td>
      <td>72</td>
    </tr>
    <tr>
      <th>Marketing Associate</th>
      <td>76119.177570</td>
      <td>81881.818182</td>
      <td>107</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Sales Associate</th>
      <td>91894.209302</td>
      <td>94663.117647</td>
      <td>43</td>
      <td>51</td>
    </tr>
    <tr>
      <th>Software Engineer</th>
      <td>94701.000000</td>
      <td>106371.485149</td>
      <td>8</td>
      <td>101</td>
    </tr>
    <tr>
      <th>Warehouse Associate</th>
      <td>92428.260870</td>
      <td>86553.431818</td>
      <td>46</td>
      <td>44</td>
    </tr>
  </tbody>
</table>

<p>Again, we apply some formating changes that will affect how the table‚Äôs looks:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Cosmetic changes to change multilevel index and making an extra column
</span><span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">to_flat_index</span><span class="p">()</span>
<span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span>

  <span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s">'Average Female Base Pay'</span><span class="p">,</span>
  <span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="s">'Average Male Base Pay'</span><span class="p">,</span>
  <span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="s">'Female headcount'</span><span class="p">,</span>
  <span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="s">'Male headcount'</span><span class="p">},</span> 
                                <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> 

<span class="n">salary_by_gender_jobtitle</span><span class="p">[</span><span class="s">'Base Pay Difference'</span><span class="p">]</span> <span class="o">=</span> <span class="n">salary_by_gender_jobtitle</span><span class="p">[</span><span class="s">'Average Female Base Pay'</span><span class="p">]</span> <span class="o">-</span> <span class="n">salary_by_gender_jobtitle</span><span class="p">[</span><span class="s">'Average Male Base Pay'</span><span class="p">]</span>

<span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s">'Base Pay Difference'</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="n">salary_by_gender_jobtitle</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
</code></pre></div></div>
<table>
  <thead>
    <tr>
      <th></th>
      <th>Average Female Base Pay</th>
      <th>Average Male Base Pay</th>
      <th>Female headcount</th>
      <th>Male headcount</th>
      <th>Base Pay Difference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Software Engineer</th>
      <td>94701</td>
      <td>106371</td>
      <td>8</td>
      <td>101</td>
      <td>-11670</td>
    </tr>
    <tr>
      <th>Marketing Associate</th>
      <td>76119</td>
      <td>81881</td>
      <td>107</td>
      <td>11</td>
      <td>-5762</td>
    </tr>
    <tr>
      <th>Driver</th>
      <td>86867</td>
      <td>91952</td>
      <td>46</td>
      <td>45</td>
      <td>-5085</td>
    </tr>
    <tr>
      <th>Sales Associate</th>
      <td>91894</td>
      <td>94663</td>
      <td>43</td>
      <td>51</td>
      <td>-2768</td>
    </tr>
    <tr>
      <th>IT</th>
      <td>90475</td>
      <td>91021</td>
      <td>50</td>
      <td>46</td>
      <td>-546</td>
    </tr>
    <tr>
      <th>Financial Analyst</th>
      <td>95458</td>
      <td>94607</td>
      <td>49</td>
      <td>58</td>
      <td>851</td>
    </tr>
    <tr>
      <th>Manager</th>
      <td>127252</td>
      <td>124848</td>
      <td>18</td>
      <td>72</td>
      <td>2403</td>
    </tr>
    <tr>
      <th>Graphic Designer</th>
      <td>92243</td>
      <td>89595</td>
      <td>48</td>
      <td>50</td>
      <td>2647</td>
    </tr>
    <tr>
      <th>Warehouse Associate</th>
      <td>92428</td>
      <td>86553</td>
      <td>46</td>
      <td>44</td>
      <td>5874</td>
    </tr>
    <tr>
      <th>Data Scientist</th>
      <td>95704</td>
      <td>89222</td>
      <td>53</td>
      <td>54</td>
      <td>6482</td>
    </tr>
  </tbody>
</table>

<p>Taking a look at the table, it is easy to see the Gender Pay Gap is affected by the kind of job that they have.</p>

<h2 id="-second-round-of-insights-">üìå Second round of Insights üìå</h2>

<ul>
  <li>There is <strong>no evident male gender gap for all the departments</strong>. For example, Female Data Scientist make 6.5k more than males in the same position. At a company level, female still earn less on average.</li>
  <li>The company show sharp differences in gender compositions in Sofware Engineering. <strong>Female Software Engineer are both under-represented (7%) and under-paid (earn 11.7k less)</strong> with respect to males.</li>
  <li>There are <strong>only 11 Male Marketing Associates but they make on average 5.7k more</strong> annually than females with the same title.</li>
</ul>

<p>It is clear that the kind of job affects the gap. Going though how all the possible factors (age, performance evaluation, education‚Ä¶) that also could have an effect would be tedious and innacurate. We will use a linear regression to explain the relationship between the salary and all the factors.</p>

<h1 id="adjusted-gender-pay-gap">Adjusted Gender Pay Gap</h1>

<p><strong>Are there differences between average pay for men and women after we‚Äôve accounted for differences among workers in education, experience, job roles, employee performance and other factors aside from gender that affect pay?</strong></p>

<p>To estimate your company‚Äôs gender pay gap, you‚Äôll need to estimate a linear regression model. This regression analysis is used to describe the relationships between the characteristics of the workers (gender, performance evaluation, job title‚Ä¶) and the salary (base pay). In the regression equation, the <strong>coefficients represent the relationship or effect</strong> between each of the variables and the salary.</p>

<p>The regression model allows to disentangle the effect on the salary of each variable, we will call them ‚Äúcontrols‚Äù, from the effect that we are looking for: gender.</p>

<h2 id="regression-model">Regression Model</h2>

\[\begin{aligned}
Log \ (Base \ Pay_i) = \beta_0 + \beta_1 gender_i + B_2 controls_i + \epsilon_i
\end{aligned}\]

<p>Explanation of the equation:</p>

<ul>
  <li>
    <p>The variable of interest is the logarithm of the base pay, \(Log \ (Base \ Pay)\), for every worker \(i\).</p>
  </li>
  <li>
    <p>\(\beta_1\) is the coefficient of interest, the effect of being a male worker on base pay.</p>
  </li>
  <li>
    <p>\(\beta_2\) represents the effect of all the other variables or characteristics, like education, job title and others.</p>
  </li>
</ul>

<p><strong>The reason of using the natural logarithm</strong> of the base salary is that it will make that the coefficients of the regression represent percentages, instead of absolute numbers. For example, a \(\beta_1\) of 0.1 can be read as a 10% increase in salary because being male. It doesn‚Äôt change the magnitude of the effect or the significance of the coefficients, only it‚Äôs interpretation.</p>

<p><strong>Including more variables will isolate the effect of gender</strong>. The more relevant variables we add to the analysis, the more isolated the effect of gender on salary. To clarify how including more controls change the estimation, we are going to do three linear regressions, adding more variables every time:</p>

<ul>
  <li>First Model. ‚ÄúUnadjusted‚Äù, without controls:</li>
</ul>

\[\begin{aligned}
Log \ (Base \ Pay_i) = \beta_0 + \beta_1 gender_i + \epsilon_i
\end{aligned}\]

<p>This equation is equivalent to the average difference in salaries by gender.</p>

<ul>
  <li>Second model. Controling for human capital (<em>Performing Evaluation, Education, Age</em>):</li>
</ul>

\[\begin{aligned}
Log \ (Base \ Pay_i) = \beta_0 + \beta_1 gender_i + \beta_2 perfEval + \beta_3 edu + \beta_4 age + \epsilon_i
\end{aligned}\]

<ul>
  <li>Third model. Controling for human capital and job characteristics (<em>Seniority, Department and Job Title</em>):</li>
</ul>

\[\begin{eqnarray}
Log \ (Base \ Pay_i) = \beta_0 + \beta_1 gender_i + \beta_2 perfEval + \beta_3 edu + \beta_4 age \\\ + \beta_5 seniority + \beta_6 dept + \beta_7 jobTitle+ \epsilon_i
\end{eqnarray}\]

<p>To build the models, we will use <code class="language-plaintext highlighter-rouge">statsmodels</code>. We will write the above formulas in the <code class="language-plaintext highlighter-rouge">formula</code> parameter, specify the dataset in <code class="language-plaintext highlighter-rouge">data</code> and call <code class="language-plaintext highlighter-rouge">fit()</code> to run the regressions. The package use is quite straightforward.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="n">sm</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Model 1 
</span><span class="n">model_1</span> <span class="o">=</span> <span class="n">sm</span><span class="p">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="s">"np.log(basePay) ~ gender"</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results_1</span> <span class="o">=</span> <span class="n">model_1</span><span class="p">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Model 2
</span><span class="n">model_2</span> <span class="o">=</span> <span class="n">sm</span><span class="p">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="s">"np.log(basePay) ~ gender + perfEval + edu + age"</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results_2</span> <span class="o">=</span> <span class="n">model_2</span><span class="p">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Model 3
</span><span class="n">model_3</span> <span class="o">=</span> <span class="n">sm</span><span class="p">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="s">"np.log(basePay) ~ gender + perfEval + edu + age + seniority + dept + jobTitle"</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span>
<span class="n">results_3</span> <span class="o">=</span> <span class="n">model_3</span><span class="p">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div></div>

<p><em>But where are the results?</em></p>

<p>I‚Äôm going to use the package <code class="language-plaintext highlighter-rouge">Stargazer</code> to print the results nicely formatted.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">stargazer.stargazer</span> <span class="kn">import</span> <span class="n">Stargazer</span>
</code></pre></div></div>

<p>I applied some cosmetic changes to display the data in a more compact way. However, if you want to display all the effects of each variable you simply run <code class="language-plaintext highlighter-rouge">Stargazer([results_1, results_2, results_3])</code> and it will provide a full table.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results_table</span> <span class="o">=</span> <span class="n">Stargazer</span><span class="p">([</span><span class="n">results_1</span><span class="p">,</span> <span class="n">results_2</span><span class="p">,</span> <span class="n">results_3</span><span class="p">])</span>

<span class="c1"># Cosmetic changes
</span><span class="n">results_table</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Gender Pay Gap Regression Results'</span><span class="p">)</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">custom_columns</span><span class="p">([</span><span class="s">'Model 1'</span><span class="p">,</span> <span class="s">'Model 2'</span><span class="p">,</span> <span class="s">'Model 3'</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">show_model_numbers</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">covariate_order</span><span class="p">([</span><span class="s">'gender[T.Male]'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">,</span> <span class="s">'perfEval'</span><span class="p">,</span> <span class="s">'seniority'</span><span class="p">])</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">rename_covariates</span><span class="p">({</span><span class="s">'age'</span><span class="p">:</span> <span class="s">'Age'</span><span class="p">,</span> 
                                 <span class="s">'gender[T.Male]'</span><span class="p">:</span> <span class="s">'Male'</span><span class="p">,</span>
                                 <span class="s">'perfEval'</span><span class="p">:</span> <span class="s">'Performance Evaluation'</span><span class="p">,</span>
                                 <span class="s">'seniority'</span><span class="p">:</span> <span class="s">'Seniority'</span><span class="p">})</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">add_line</span><span class="p">(</span><span class="s">'Controls included:'</span><span class="p">,</span> <span class="p">[</span><span class="s">' '</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span> <span class="s">' '</span><span class="p">])</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">add_line</span><span class="p">(</span><span class="s">'Department'</span><span class="p">,</span> <span class="p">[</span><span class="s">'X'</span><span class="p">,</span> <span class="s">'X'</span><span class="p">,</span>  <span class="sa">u</span><span class="s">'</span><span class="se">\u2713</span><span class="s">'</span><span class="p">])</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">add_line</span><span class="p">(</span><span class="s">'Job Title'</span><span class="p">,</span> <span class="p">[</span><span class="s">'X'</span><span class="p">,</span> <span class="s">'X'</span><span class="p">,</span>  <span class="sa">u</span><span class="s">'</span><span class="se">\u2713</span><span class="s">'</span><span class="p">])</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">add_line</span><span class="p">(</span><span class="s">'Education'</span><span class="p">,</span> <span class="p">[</span><span class="s">'X'</span><span class="p">,</span> <span class="sa">u</span><span class="s">'</span><span class="se">\u2713</span><span class="s">'</span><span class="p">,</span>  <span class="sa">u</span><span class="s">'</span><span class="se">\u2713</span><span class="s">'</span><span class="p">])</span>
<span class="n">results_table</span><span class="p">.</span><span class="n">show_degrees_of_freedom</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">results_table</span>
</code></pre></div></div>

<p class="mark">Gender Pay Gap Regression Results</p>

<table>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3"><em>Dependent variable:np.log(basePay)</em>
</td>
<td style="text-align:left">
</td>
<tr>
<td>
</td>
<td colspan="1">Model 1
</td>
<td colspan="1">Model 2
</td>
<td colspan="1">Model 3
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">Male
</td>
<td>0.095<sup>***</sup>
</td>
<td>0.100<sup>***</sup>
</td>
<td>0.011<sup></sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>(0.018)
</td>
<td>(0.015)
</td>
<td>(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">Age
</td>
<td>
</td>
<td>0.011<sup>***</sup>
</td>
<td>0.011<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>(0.001)
</td>
<td>(0.000)
</td>
</tr>
<tr>
<td style="text-align:left">Performance Evaluation
</td>
<td>
</td>
<td>-0.007<sup></sup>
</td>
<td>0.000<sup></sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>(0.005)
</td>
<td>(0.003)
</td>
</tr>
<tr>
<td style="text-align:left">Seniority
</td>
<td>
</td>
<td>
</td>
<td>0.109<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>(0.003)
</td>
</tr>
<tr>
<td style="text-align: left">Controls included:
</td>
<td> 
</td>
<td> 
</td>
<td> 
</td>
</tr>
<tr>
<td style="text-align: left">Department
</td>
<td>X
</td>
<td>X
</td>
<td>‚úì
</td>
</tr>
<tr>
<td style="text-align: left">Job Title
</td>
<td>X
</td>
<td>X
</td>
<td>‚úì
</td>
</tr>
<tr>
<td style="text-align: left">Education
</td>
<td>X
</td>
<td>‚úì
</td>
<td>‚úì
</td>
</tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align: left">Observations
</td>
<td>1,000
</td>
<td>1,000
</td>
<td>1,000
</td>
</tr>
<tr>
<td style="text-align: left">R<sup>2</sup>
</td>
<td>0.027
</td>
<td>0.366
</td>
<td>0.810
</td>
</tr>
<tr>
<td style="text-align: left">Adjusted R<sup>2</sup>
</td>
<td>0.026
</td>
<td>0.363
</td>
<td>0.806
</td>
</tr>
<tr>
<td style="text-align: left">Residual Std. Error
</td>
<td>0.283
</td>
<td>0.229
</td>
<td>0.127
</td>
</tr>
<tr>
<td style="text-align: left">F Statistic
</td>
<td>28.185<sup>***</sup>
</td>
<td>95.682<sup>***</sup>
</td>
<td>208.164<sup>***</sup>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align: left">Note:
</td>
 <td colspan="3" style="text-align: right">
  <sup>*</sup>p&lt;0.1;
  <sup>**</sup>p&lt;0.05;
  <sup>***</sup>p&lt;0.01
 </td></tr></table>

<h2 id="how-to-interpret-the-results">How to interpret the results?</h2>

<p>Model 1 is the simplest model (the ‚Äúunadjusted‚Äù pay gap), Model 2 adds controls for employee personal characteristics, and Model 3 adds all of our controls (the ‚Äúadjusted‚Äù pay gap). The starts represent thresholds for p-values. The estimates that are statistically significant have <em>, ** or **</em> next to them.</p>

<p><strong>The first row</strong> of the table shows our estimates of the ‚Äúunadjusted‚Äù and ‚Äúadjusted‚Äù gender pay gap. That‚Äôs the coefficient on the effect of the male gender.</p>

<ul>
  <li>
    <p><strong>In <code class="language-plaintext highlighter-rouge">Model 1</code></strong>, a coefficient of 0.095 means there is approximately 9.5 percent ‚Äúunadjusted‚Äù gender pay gap in our hypothetical company. Put differently, men on average earn about 9.5 percent more than women on average in this company. We also see this estimate is highly statistically significant. If you remember, this is exactly the same results that we got by simply comparing the salary between male and female base salary.</p>
  </li>
  <li>
    <p><strong>In <code class="language-plaintext highlighter-rouge">Model 2</code></strong>, we add individual controls like age, performance evaluations and education. Here we see the gender pay gap hasn‚Äôt changed much. It‚Äôs still a 10 percent pay gap, which is still highly statistically significant. Whatever is causing the pay gap in our hypothetical employer isn‚Äôt due to differences in education, age or performance evaluations of men and women.</p>
  </li>
  <li>
    <p><strong>In <code class="language-plaintext highlighter-rouge">Model 3</code></strong>, we add all of the controls we have in our dataset. <strong>This is the ‚Äúadjusted‚Äù Gender Pay Gap</strong>. In this case, we see the gender pay gap shrinks to 1.1 percent after controlling for job title, job seniority and company department. More importantly, <strong>this estimate is no longer statistically significant</strong> ‚Äî so we can‚Äôt conclude that the coefficient it‚Äôs really different from zero.</p>
  </li>
</ul>

<p>In this case, we say there‚Äôs <strong>no evidence of a systematic Gender Pay Gap on an ‚Äúadjusted‚Äù basis</strong>, after controlling for observable differences between male and female workers.</p>

<p><strong>The last rows</strong> of the table represent different metrics that basically evaluate how good is the model fitting the data, and the overall significance for a regression model. The important metric here \(R^2\).</p>

<p>Both \(R^2\) and \(Adjusted \ R^2\) are statistical measures that represents the proportion of the variance for a dependent variable that‚Äôs explained by the independent variables. In this case, <strong>0.81  means that 81% of the observed variation in workers salaries can be explained by their gender, age, evaluation, and the rest of their characteristics included</strong>. Given that there is only 19% of the variation in the salaries that we cannot explain, it‚Äôs a great model fit.</p>

<h2 id="-third-round-of-insights-">üìå Third round of Insights üìå</h2>

<ul>
  <li>
    <p>Once we control for the fact that men and women work in different roles in this company, the remaining pay difference that‚Äôs due to <strong>the gender pay gap shrinks to near zero</strong>.</p>
  </li>
  <li>
    <p>Why? <strong>Men are over-represented in higher-paying software engineer and manager roles</strong>, while they are under-represented in lower-paying marketing roles.</p>
  </li>
</ul>

<h2 id="what-to-do-with-the-results">What to do with the results?</h2>

<p>Performing a gender pay audit at your company is an important first step. Once you‚Äôve completed your analysis, what‚Äôs the next step?</p>

<p>First, <strong>you should decide whether to share your findings internally with employees</strong>.</p>

<p>Being transparent about your efforts to pay workers fairly can help boost employee engagement, and contribute toward a healthy culture of fair pay and openness. However, internal communication of the results of your gender pay audit may not be right for every employer ‚Äî it‚Äôs a decision leadership teams will approach differently.</p>

<p>Second, <strong>you will have to decide whether the results of your gender pay audit suggest that changes may be necessary in your company‚Äôs pay and hiring systems</strong>.</p>

<p><strong>If your analysis identifies a large ‚Äúadjusted‚Äù pay gap</strong>, or particularly large gender gaps within certain departments or job titles, your analysis can help target where to invest efforts to improve pay fairness in the future.</p>

<p>Even <strong>if you prove no evidence ‚Äúadjusted‚Äù pay gap</strong>, it is important to calculate the ‚Äúunadjusted‚Äù pay gap to detect areas of improvements. In our example, a good following question would be why there are only a 9% of women in Software Engeneering teams and what can we do to hire more women in high paid positions.</p>
:ET